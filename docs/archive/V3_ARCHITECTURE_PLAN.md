# Voice Clone TTS v3.0 - ä¼ä¸šçº§æ¶æ„è®¾è®¡æ–¹æ¡ˆ

## ä¸€ã€æ¶æ„æ€»è§ˆ

### 1.1 è®¾è®¡ç›®æ ‡

- **å¾®æœåŠ¡æ¶æ„**: è§£è€¦å„ç»„ä»¶ï¼Œæ”¯æŒç‹¬ç«‹éƒ¨ç½²ä¸æ‰©å±•
- **æœåŠ¡æ³¨å†Œä¸å‘ç°**: å¤šæœºå™¨éƒ¨ç½²ï¼Œè‡ªåŠ¨æ³¨å†Œä¸è´Ÿè½½å‡è¡¡
- **å¯è§†åŒ–ç®¡ç†**: çŠ¶æ€ç›‘æ§ã€ç®¡ç†æ§åˆ¶ã€APIæµ‹è¯•ä¸‰å¤§é¡µé¢
- **ä¼ä¸šçº§ç‰¹æ€§**: æ—¥å¿—ç³»ç»Ÿã€é™æµç†”æ–­ã€å¥åº·æ£€æŸ¥
- **ç¦»çº¿éƒ¨ç½²**: æ¨¡å‹åˆ†å·å‹ç¼©ï¼Œå®Œæ•´ç¦»çº¿åŒ…

### 1.2 ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Nginx / ç½‘å…³å±‚                                  â”‚
â”‚                    (è´Ÿè½½å‡è¡¡ / SSLç»ˆæ­¢ / è·¯ç”±è½¬å‘)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Gateway Service (ç½‘å…³æœåŠ¡)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ çŠ¶æ€é¡µé¢    â”‚  â”‚ ç®¡ç†é¡µé¢    â”‚  â”‚ æµ‹è¯•é¡µé¢    â”‚  â”‚ API è·¯ç”±    â”‚    â”‚
â”‚  â”‚ /status     â”‚  â”‚ /admin      â”‚  â”‚ /playground â”‚  â”‚ /api/v3/*   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    æœåŠ¡æ³¨å†Œä¸­å¿ƒ (Registry)                        â”‚   â”‚
â”‚  â”‚         - èŠ‚ç‚¹æ³¨å†Œ/å¿ƒè·³ - å¥åº·æ£€æŸ¥ - è´Ÿè½½å‡è¡¡                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                    â”‚                    â”‚
          â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  XTTS Worker    â”‚  â”‚ OpenVoice Workerâ”‚  â”‚ GPT-SoVITS Workerâ”‚
â”‚  Node 1         â”‚  â”‚  Node 1         â”‚  â”‚  Node 1          â”‚
â”‚  :8001          â”‚  â”‚  :8002          â”‚  â”‚  :9880           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  XTTS Worker    â”‚  â”‚ OpenVoice Workerâ”‚  â”‚ GPT-SoVITS Workerâ”‚
â”‚  Node 2         â”‚  â”‚  Node 2         â”‚  â”‚  Node 2          â”‚
â”‚  :8011          â”‚  â”‚  :8012          â”‚  â”‚  :9881           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€æ ¸å¿ƒç»„ä»¶è®¾è®¡

### 2.1 ç›®å½•ç»“æ„

```
voice-clone-tts/
â”œâ”€â”€ v3/                          # v3 ç‰ˆæœ¬ä»£ç 
â”‚   â”œâ”€â”€ gateway/                 # ç½‘å…³æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ app.py              # FastAPI ä¸»åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ registry.py         # æœåŠ¡æ³¨å†Œä¸­å¿ƒ
â”‚   â”‚   â”œâ”€â”€ router.py           # è¯·æ±‚è·¯ç”±/è´Ÿè½½å‡è¡¡
â”‚   â”‚   â”œâ”€â”€ limiter.py          # é™æµå™¨
â”‚   â”‚   â””â”€â”€ config.py           # é…ç½®ç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ workers/                 # å·¥ä½œèŠ‚ç‚¹
â”‚   â”‚   â”œâ”€â”€ base_worker.py      # å·¥ä½œèŠ‚ç‚¹åŸºç±»
â”‚   â”‚   â”œâ”€â”€ xtts_worker.py      # XTTS å·¥ä½œèŠ‚ç‚¹
â”‚   â”‚   â”œâ”€â”€ openvoice_worker.py # OpenVoice å·¥ä½œèŠ‚ç‚¹
â”‚   â”‚   â””â”€â”€ gpt_sovits_worker.py# GPT-SoVITS å·¥ä½œèŠ‚ç‚¹
â”‚   â”‚
â”‚   â”œâ”€â”€ web/                     # Web é¡µé¢
â”‚   â”‚   â”œâ”€â”€ static/             # é™æ€èµ„æº
â”‚   â”‚   â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”‚   â””â”€â”€ img/
â”‚   â”‚   â”œâ”€â”€ templates/          # Jinja2 æ¨¡æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ base.html
â”‚   â”‚   â”‚   â”œâ”€â”€ status.html     # çŠ¶æ€ç›‘æ§é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ admin.html      # ç®¡ç†æ§åˆ¶é¡µ
â”‚   â”‚   â”‚   â””â”€â”€ playground.html # API æµ‹è¯•é¡µ
â”‚   â”‚   â””â”€â”€ routes.py           # é¡µé¢è·¯ç”±
â”‚   â”‚
â”‚   â”œâ”€â”€ common/                  # å…¬å…±æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ logger.py           # å¢å¼ºæ—¥å¿—ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ metrics.py          # æŒ‡æ ‡æ”¶é›†
â”‚   â”‚   â”œâ”€â”€ models.py           # æ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ exceptions.py       # å¼‚å¸¸å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ cli/                     # CLI å·¥å…·
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ gateway_cli.py      # ç½‘å…³ç®¡ç†å‘½ä»¤
â”‚   â”‚   â””â”€â”€ worker_cli.py       # å·¥ä½œèŠ‚ç‚¹å‘½ä»¤
â”‚   â”‚
â”‚   â””â”€â”€ scripts/                 # éƒ¨ç½²è„šæœ¬
â”‚       â”œâ”€â”€ start_gateway.py
â”‚       â”œâ”€â”€ start_worker.py
â”‚       â””â”€â”€ pack_models.py      # æ¨¡å‹æ‰“åŒ…è„šæœ¬
â”‚
â”œâ”€â”€ models/                      # æ¨¡å‹å­˜å‚¨
â”‚   â”œâ”€â”€ xtts_v2/
â”‚   â”‚   â”œâ”€â”€ xtts_v2.pkg.part_*  # åˆ†å·å‹ç¼©åŒ…
â”‚   â”‚   â””â”€â”€ README.md           # è¿˜åŸè¯´æ˜
â”‚   â”œâ”€â”€ openvoice/
â”‚   â”‚   â”œâ”€â”€ openvoice.pkg.part_*
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â””â”€â”€ gpt_sovits/
â”‚       â”œâ”€â”€ gpt_sovits.pkg.part_*
â”‚       â””â”€â”€ README.md
â”‚
â”œâ”€â”€ config/                      # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ gateway.yaml            # ç½‘å…³é…ç½®
â”‚   â”œâ”€â”€ worker.yaml             # å·¥ä½œèŠ‚ç‚¹é…ç½®
â”‚   â””â”€â”€ nginx.conf              # Nginx ç¤ºä¾‹é…ç½®
â”‚
â””â”€â”€ docs/                        # æ–‡æ¡£
    â”œâ”€â”€ DEPLOYMENT.md           # éƒ¨ç½²æŒ‡å—
    â”œâ”€â”€ API_REFERENCE.md        # API æ–‡æ¡£
    â””â”€â”€ ADMIN_GUIDE.md          # ç®¡ç†æŒ‡å—
```

### 2.2 æœåŠ¡æ³¨å†Œä¸­å¿ƒ

```python
# registry.py - æœåŠ¡æ³¨å†Œä¸­å¿ƒè®¾è®¡

class ServiceRegistry:
    """
    è½»é‡çº§æœåŠ¡æ³¨å†Œä¸­å¿ƒ

    åŠŸèƒ½:
    - æœåŠ¡æ³¨å†Œ/æ³¨é”€
    - å¿ƒè·³æ£€æµ‹
    - å¥åº·æ£€æŸ¥
    - è´Ÿè½½å‡è¡¡ç­–ç•¥
    """

    def __init__(self):
        self.services = {}  # {service_type: [node_info, ...]}
        self.heartbeat_interval = 10  # ç§’
        self.dead_threshold = 30  # è¶…æ—¶é˜ˆå€¼

    async def register(self, node_info: NodeInfo) -> str:
        """æ³¨å†ŒæœåŠ¡èŠ‚ç‚¹"""
        pass

    async def deregister(self, node_id: str):
        """æ³¨é”€æœåŠ¡èŠ‚ç‚¹"""
        pass

    async def heartbeat(self, node_id: str, metrics: NodeMetrics):
        """å¿ƒè·³ä¸ŠæŠ¥"""
        pass

    async def get_available_node(self, service_type: str) -> NodeInfo:
        """è·å–å¯ç”¨èŠ‚ç‚¹ï¼ˆè´Ÿè½½å‡è¡¡ï¼‰"""
        pass

    async def get_all_nodes(self) -> dict:
        """è·å–æ‰€æœ‰èŠ‚ç‚¹çŠ¶æ€"""
        pass
```

### 2.3 å·¥ä½œèŠ‚ç‚¹è®¾è®¡

```python
# base_worker.py - å·¥ä½œèŠ‚ç‚¹åŸºç±»

class BaseWorker:
    """
    å·¥ä½œèŠ‚ç‚¹åŸºç±»

    ç”Ÿå‘½å‘¨æœŸ:
    1. å¯åŠ¨ -> æ³¨å†Œåˆ°ç½‘å…³
    2. è¿è¡Œ -> å®šæ—¶å¿ƒè·³ + å¤„ç†è¯·æ±‚
    3. åœæ­¢ -> ä»ç½‘å…³æ³¨é”€

    çŠ¶æ€:
    - standby: å¾…æœºï¼ˆæ¨¡å‹æœªåŠ è½½ï¼ŒèŠ‚çœèµ„æºï¼‰
    - loading: åŠ è½½ä¸­
    - ready: å°±ç»ªï¼ˆå¯æ¥å—è¯·æ±‚ï¼‰
    - busy: ç¹å¿™
    - error: é”™è¯¯
    """

    ENGINE_TYPE: str = "base"

    def __init__(self, config: WorkerConfig):
        self.config = config
        self.status = WorkerStatus.STANDBY
        self.model_loaded = False
        self.request_count = 0
        self.error_count = 0

    async def start(self):
        """å¯åŠ¨å·¥ä½œèŠ‚ç‚¹"""
        await self.register_to_gateway()
        await self.start_heartbeat_task()

    async def stop(self):
        """åœæ­¢å·¥ä½œèŠ‚ç‚¹"""
        await self.deregister_from_gateway()

    async def load_model(self):
        """åŠ è½½æ¨¡å‹ï¼ˆå»¶è¿ŸåŠ è½½ï¼‰"""
        pass

    async def unload_model(self):
        """å¸è½½æ¨¡å‹ï¼ˆé‡Šæ”¾èµ„æºï¼‰"""
        pass

    async def process_request(self, request):
        """å¤„ç†è¯·æ±‚"""
        pass

    def get_metrics(self) -> NodeMetrics:
        """è·å–èŠ‚ç‚¹æŒ‡æ ‡"""
        pass
```

---

## ä¸‰ã€é¡µé¢è®¾è®¡

### 3.1 çŠ¶æ€ç›‘æ§é¡µ (/status)

**åŠŸèƒ½éœ€æ±‚:**
- æ˜¾ç¤ºæ‰€æœ‰æ³¨å†ŒèŠ‚ç‚¹çŠ¶æ€ï¼ˆåœ¨çº¿/ç¦»çº¿/é”™è¯¯ï¼‰
- æ˜¾ç¤ºå„èŠ‚ç‚¹èµ„æºä½¿ç”¨ï¼ˆCPU/GPU/å†…å­˜ï¼‰
- æ˜¾ç¤ºè¯·æ±‚å¹¶å‘æ•°å’Œå¤„ç†é˜Ÿåˆ—
- æ˜¾ç¤ºæ¥å£å¯è¾¾æ€§æ£€æµ‹ç»“æœ
- æ˜¾ç¤ºé‡è¦é”™è¯¯å…¬å‘Š
- å®æ—¶åˆ·æ–°ï¼ˆWebSocket æˆ–è½®è¯¢ï¼‰

**ç•Œé¢å¸ƒå±€:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Voice Clone TTS - ç³»ç»ŸçŠ¶æ€                    [è‡ªåŠ¨åˆ·æ–°: ON]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ğŸ“¢ å…¬å‘ŠåŒºåŸŸ                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [è­¦å‘Š] GPT-SoVITS Node 2 ç¦»çº¿ (2025-11-29 10:30)        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“Š ç³»ç»Ÿæ¦‚è§ˆ                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ åœ¨çº¿èŠ‚ç‚¹ â”‚ â”‚ æ€»è¯·æ±‚æ•° â”‚ â”‚ å½“å‰å¹¶å‘ â”‚ â”‚ å¹³å‡å»¶è¿Ÿ â”‚          â”‚
â”‚  â”‚    5     â”‚ â”‚  12,345  â”‚ â”‚    23    â”‚ â”‚  1.2s   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                 â”‚
â”‚  ğŸ–¥ï¸ å¼•æ“çŠ¶æ€                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ XTTS-v2                                                  â”‚   â”‚
â”‚  â”‚ â”œâ”€â”€ Node 1 (192.168.1.10:8001) â— Ready   CPU:45% GPU:60%â”‚   â”‚
â”‚  â”‚ â””â”€â”€ Node 2 (192.168.1.11:8001) â— Ready   CPU:30% GPU:45%â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ OpenVoice                                                â”‚   â”‚
â”‚  â”‚ â””â”€â”€ Node 1 (192.168.1.10:8002) â— Standby                â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ GPT-SoVITS                                               â”‚   â”‚
â”‚  â”‚ â”œâ”€â”€ Node 1 (192.168.1.10:9880) â— Ready   CPU:50% GPU:80%â”‚   â”‚
â”‚  â”‚ â””â”€â”€ Node 2 (192.168.1.12:9880) â—‹ Offline                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  ğŸ”— æ¥å£å¥åº·æ£€æŸ¥                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ /api/v3/synthesize      âœ… 200 OK     (avg: 1.5s)       â”‚   â”‚
â”‚  â”‚ /api/v3/extract_voice   âœ… 200 OK     (avg: 2.1s)       â”‚   â”‚
â”‚  â”‚ /api/v3/voices          âœ… 200 OK     (avg: 0.1s)       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ç®¡ç†æ§åˆ¶é¡µ (/admin)

**åŠŸèƒ½éœ€æ±‚:**
- æŸ¥çœ‹/ç¼–è¾‘èŠ‚ç‚¹é…ç½®
- å¯åŠ¨/åœæ­¢/é‡å¯å·¥ä½œèŠ‚ç‚¹
- åˆ‡æ¢èŠ‚ç‚¹çŠ¶æ€ï¼ˆReady/Standbyï¼‰
- æ¨¡å‹åŠ è½½/å¸è½½æ§åˆ¶
- æŸ¥çœ‹æ—¥å¿—
- ç³»ç»Ÿé…ç½®ç®¡ç†

**ç•Œé¢å¸ƒå±€:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Voice Clone TTS - ç®¡ç†æ§åˆ¶å°                    [ç”¨æˆ·: admin]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ğŸ›ï¸ èŠ‚ç‚¹ç®¡ç†                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ èŠ‚ç‚¹             çŠ¶æ€      æ¨¡å‹      æ“ä½œ               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ XTTS Node 1      Ready     Loaded    [Standby] [é‡å¯]   â”‚   â”‚
â”‚  â”‚ XTTS Node 2      Standby   Unloaded  [æ¿€æ´»]   [åœæ­¢]   â”‚   â”‚
â”‚  â”‚ OpenVoice Node 1 Standby   Unloaded  [æ¿€æ´»]   [åœæ­¢]   â”‚   â”‚
â”‚  â”‚ GPT-SoVITS Node 1 Ready    Loaded    [Standby] [é‡å¯]   â”‚   â”‚
â”‚  â”‚ GPT-SoVITS Node 2 Offline  -         [å¯åŠ¨]            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  âš™ï¸ å…¨å±€è®¾ç½®                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ é™æµé…ç½®:   æ¯åˆ†é’Ÿæœ€å¤§è¯·æ±‚: [100]   å¹¶å‘ä¸Šé™: [10]      â”‚   â”‚
â”‚  â”‚ é»˜è®¤å¼•æ“:   [XTTS-v2 â–¼]                                 â”‚   â”‚
â”‚  â”‚ æ—¥å¿—çº§åˆ«:   [INFO â–¼]                                    â”‚   â”‚
â”‚  â”‚                                        [ä¿å­˜é…ç½®]       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“œ å®æ—¶æ—¥å¿—                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 2025-11-29 10:30:15 [INFO] XTTS Node 1: åˆæˆå®Œæˆ (1.2s) â”‚   â”‚
â”‚  â”‚ 2025-11-29 10:30:12 [INFO] æ”¶åˆ°åˆæˆè¯·æ±‚: "ä½ å¥½ä¸–ç•Œ"      â”‚   â”‚
â”‚  â”‚ 2025-11-29 10:30:00 [WARN] GPT-SoVITS Node 2: å¿ƒè·³è¶…æ—¶  â”‚   â”‚
â”‚  â”‚ ...                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 API æµ‹è¯•é¡µ (/playground)

**åŠŸèƒ½éœ€æ±‚:**
- æä¾›æ‰€æœ‰ API çš„äº¤äº’å¼æµ‹è¯•ç•Œé¢
- è¡¨å•å¼•å¯¼å¡«å†™å‚æ•°
- æ–‡ä»¶ä¸Šä¼ æ”¯æŒ
- è¯·æ±‚/å“åº”å®æ—¶å±•ç¤º
- éŸ³é¢‘æ’­æ”¾å™¨
- ä»£ç ç¤ºä¾‹ç”Ÿæˆï¼ˆPython/cURLï¼‰

**ç•Œé¢å¸ƒå±€:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Voice Clone TTS - API Playground                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  é€‰æ‹©æ¥å£: [è¯­éŸ³åˆæˆ (synthesize) â–¼]                            â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“ è¯·æ±‚å‚æ•°                                              â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ å¼•æ“:     [XTTS-v2 â–¼]                                   â”‚   â”‚
â”‚  â”‚ éŸ³è‰²ID:   [test_voice â–¼] (æˆ–è¾“å…¥è‡ªå®šä¹‰)                  â”‚   â”‚
â”‚  â”‚ æ–‡æœ¬:     [                                      ]      â”‚   â”‚
â”‚  â”‚           ä½ å¥½ï¼Œè¿™æ˜¯è¯­éŸ³åˆæˆæµ‹è¯•                         â”‚   â”‚
â”‚  â”‚ è¯­è¨€:     [ä¸­æ–‡ â–¼]                                      â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚                                         [â–¶ å‘é€è¯·æ±‚]    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“¤ å“åº”ç»“æœ                              è€—æ—¶: 1.234s   â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ çŠ¶æ€: 200 OK                                            â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚ ğŸ”Š éŸ³é¢‘æ’­æ”¾å™¨                                           â”‚   â”‚
â”‚  â”‚ [â–¶ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â—‹â”€â”€â”€â”€â”€ ] 00:03 / 00:05           â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚ [ä¸‹è½½éŸ³é¢‘] [å¤åˆ¶ cURL] [å¤åˆ¶ Python]                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ’» ä»£ç ç¤ºä¾‹                                              â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ # Python                                                 â”‚   â”‚
â”‚  â”‚ import requests                                          â”‚   â”‚
â”‚  â”‚ response = requests.post(                                â”‚   â”‚
â”‚  â”‚     "http://localhost:8000/api/v3/synthesize",          â”‚   â”‚
â”‚  â”‚     json={"text": "ä½ å¥½...", "voice_id": "test_voice"}  â”‚   â”‚
â”‚  â”‚ )                                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å››ã€API è®¾è®¡ (v3)

### 4.1 API ç«¯ç‚¹åˆ—è¡¨

| ç«¯ç‚¹ | æ–¹æ³• | æè¿° |
|------|------|------|
| `/api/v3/synthesize` | POST | è¯­éŸ³åˆæˆ |
| `/api/v3/synthesize/stream` | POST | æµå¼åˆæˆ |
| `/api/v3/synthesize/batch` | POST | æ‰¹é‡åˆæˆ |
| `/api/v3/extract_voice` | POST | æå–éŸ³è‰² |
| `/api/v3/voices` | GET | åˆ—å‡ºéŸ³è‰² |
| `/api/v3/voices/{id}` | GET/DELETE | éŸ³è‰²è¯¦æƒ…/åˆ é™¤ |
| `/api/v3/preprocess` | POST | éŸ³é¢‘é¢„å¤„ç† |
| `/api/v3/engines` | GET | å¯ç”¨å¼•æ“åˆ—è¡¨ |
| `/api/v3/nodes` | GET | èŠ‚ç‚¹çŠ¶æ€ |
| `/api/v3/health` | GET | å¥åº·æ£€æŸ¥ |
| `/api/v3/metrics` | GET | æŒ‡æ ‡æ•°æ® |

### 4.2 ç®¡ç† API

| ç«¯ç‚¹ | æ–¹æ³• | æè¿° |
|------|------|------|
| `/admin/api/nodes` | GET | è·å–æ‰€æœ‰èŠ‚ç‚¹ |
| `/admin/api/nodes/{id}/start` | POST | å¯åŠ¨èŠ‚ç‚¹ |
| `/admin/api/nodes/{id}/stop` | POST | åœæ­¢èŠ‚ç‚¹ |
| `/admin/api/nodes/{id}/activate` | POST | æ¿€æ´»èŠ‚ç‚¹ï¼ˆåŠ è½½æ¨¡å‹ï¼‰|
| `/admin/api/nodes/{id}/standby` | POST | å¾…æœºèŠ‚ç‚¹ï¼ˆå¸è½½æ¨¡å‹ï¼‰|
| `/admin/api/config` | GET/PUT | è·å–/æ›´æ–°é…ç½® |
| `/admin/api/logs` | GET | è·å–æ—¥å¿— |
| `/admin/api/announcements` | GET/POST | å…¬å‘Šç®¡ç† |

---

## äº”ã€é™æµä¸æ—¥å¿—

### 5.1 é™æµç­–ç•¥

```python
# limiter.py

class RateLimiter:
    """
    å¤šå±‚é™æµå™¨

    å±‚çº§:
    1. å…¨å±€é™æµ: ä¿æŠ¤æ•´ä¸ªç³»ç»Ÿ
    2. IPé™æµ: é˜²æ­¢å•ä¸ªå®¢æˆ·ç«¯æ»¥ç”¨
    3. æ¥å£é™æµ: ä¿æŠ¤ç‰¹å®šæ¥å£
    4. èŠ‚ç‚¹é™æµ: é˜²æ­¢å•èŠ‚ç‚¹è¿‡è½½
    """

    def __init__(self, config: LimiterConfig):
        self.global_limit = config.global_requests_per_minute
        self.ip_limit = config.ip_requests_per_minute
        self.endpoint_limits = config.endpoint_limits
        self.node_limits = config.node_limits

    async def check_limit(self, request) -> bool:
        """æ£€æŸ¥æ˜¯å¦è¶…é™"""
        pass

    async def record_request(self, request):
        """è®°å½•è¯·æ±‚"""
        pass
```

### 5.2 æ—¥å¿—ç³»ç»Ÿå¢å¼º

```python
# æ—¥å¿—åˆ†ç±»
LOGGERS = {
    "access": "è®¿é—®æ—¥å¿— - è®°å½•æ‰€æœ‰ HTTP è¯·æ±‚",
    "error": "é”™è¯¯æ—¥å¿— - è®°å½•å¼‚å¸¸å’Œé”™è¯¯",
    "audit": "å®¡è®¡æ—¥å¿— - è®°å½•ç®¡ç†æ“ä½œ",
    "metrics": "æŒ‡æ ‡æ—¥å¿— - è®°å½•æ€§èƒ½æ•°æ®",
}

# æ—¥å¿—æ ¼å¼
LOG_FORMAT = {
    "timestamp": "ISO 8601",
    "level": "DEBUG/INFO/WARNING/ERROR/CRITICAL",
    "request_id": "UUID",
    "client_ip": "IPåœ°å€",
    "endpoint": "è¯·æ±‚ç«¯ç‚¹",
    "method": "HTTPæ–¹æ³•",
    "status_code": "å“åº”çŠ¶æ€ç ",
    "duration_ms": "è€—æ—¶(æ¯«ç§’)",
    "message": "æ—¥å¿—æ¶ˆæ¯",
    "extra": "é¢å¤–æ•°æ®(JSON)",
}
```

---

## å…­ã€æ¨¡å‹åˆ†å·ç®¡ç†

### 6.1 åˆ†å·å‹ç¼©æ–¹æ¡ˆ

```bash
# åˆ†å·å‹ç¼©å‘½ä»¤ï¼ˆæ¯å·100MBï¼‰
split -b 100M model_file.tar.gz model_file.pkg.part_

# ç›®å½•ç»“æ„
models/
â”œâ”€â”€ xtts_v2/
â”‚   â”œâ”€â”€ xtts_v2.pkg.part_aa
â”‚   â”œâ”€â”€ xtts_v2.pkg.part_ab
â”‚   â”œâ”€â”€ ...
â”‚   â”œâ”€â”€ xtts_v2.pkg.part_aj  (çº¦2GB, 21ä¸ªåˆ†å·)
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ openvoice/
â”‚   â”œâ”€â”€ openvoice.pkg.part_aa
â”‚   â”œâ”€â”€ openvoice.pkg.part_ab
â”‚   â””â”€â”€ README.md
â””â”€â”€ gpt_sovits/
    â”œâ”€â”€ gpt_sovits.pkg.part_aa
    â”œâ”€â”€ ...
    â””â”€â”€ README.md
```

### 6.2 æ¨¡å‹è¿˜åŸè„šæœ¬

```python
# scripts/restore_models.py

def restore_model(model_dir: str, output_dir: str):
    """
    è¿˜åŸåˆ†å·å‹ç¼©çš„æ¨¡å‹

    1. åˆå¹¶åˆ†å·: cat part_* > full.tar.gz
    2. è§£å‹: tar -xzf full.tar.gz
    3. æ ¡éªŒ: æ£€æŸ¥æ–‡ä»¶å®Œæ•´æ€§
    """
    pass
```

---

## ä¸ƒã€å®æ–½è®¡åˆ’

### Phase 1: åŸºç¡€æ¡†æ¶ (æ ¸å¿ƒ)
1. åˆ›å»º v3 ç›®å½•ç»“æ„
2. å®ç°æœåŠ¡æ³¨å†Œä¸­å¿ƒ
3. å®ç°å·¥ä½œèŠ‚ç‚¹åŸºç±»
4. å®ç° XTTS å·¥ä½œèŠ‚ç‚¹

### Phase 2: ç½‘å…³æœåŠ¡
1. å®ç° Gateway ä¸»åº”ç”¨
2. å®ç°è¯·æ±‚è·¯ç”±å’Œè´Ÿè½½å‡è¡¡
3. å®ç°é™æµå™¨
4. å®ç°å¥åº·æ£€æŸ¥

### Phase 3: Web é¡µé¢
1. çŠ¶æ€ç›‘æ§é¡µ
2. ç®¡ç†æ§åˆ¶é¡µ
3. API æµ‹è¯•é¡µ
4. WebSocket å®æ—¶æ¨é€

### Phase 4: å®Œå–„åŠŸèƒ½
1. OpenVoice å·¥ä½œèŠ‚ç‚¹
2. GPT-SoVITS å·¥ä½œèŠ‚ç‚¹
3. å®Œæ•´æ—¥å¿—ç³»ç»Ÿ
4. é…ç½®ç®¡ç†

### Phase 5: ç¦»çº¿éƒ¨ç½²
1. æ¨¡å‹åˆ†å·å‹ç¼©
2. ç¦»çº¿å®‰è£…åŒ…
3. éƒ¨ç½²è„šæœ¬
4. å®Œæ•´æ–‡æ¡£

---

## å…«ã€æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯é€‰å‹ |
|------|----------|
| Web æ¡†æ¶ | FastAPI |
| æ¨¡æ¿å¼•æ“ | Jinja2 |
| å‰ç«¯æ¡†æ¶ | TailwindCSS + Alpine.js |
| å®æ—¶é€šä¿¡ | WebSocket / SSE |
| é™æµ | è‡ªå®ç° (Redis å¯é€‰) |
| æ—¥å¿— | Python logging + coloredlogs |
| é…ç½® | YAML + Pydantic |
| CLI | Click |
| æ‰“åŒ… | PyInstaller (å¯é€‰) |

---

## ä¹ã€é…ç½®æ–‡ä»¶ç¤ºä¾‹

### gateway.yaml

```yaml
server:
  host: 0.0.0.0
  port: 8000
  workers: 4

registry:
  heartbeat_interval: 10
  dead_threshold: 30

limiter:
  enabled: true
  global_rpm: 1000
  ip_rpm: 100
  concurrent_limit: 50

logging:
  level: INFO
  file: logs/gateway.log
  max_size: 10MB
  backup_count: 5

auth:
  admin_password: ${ADMIN_PASSWORD:admin123}
  api_key_enabled: false

announcements:
  - type: warning
    message: "ç³»ç»Ÿç»´æŠ¤é€šçŸ¥"
    expires: "2025-12-01"
```

### worker.yaml

```yaml
worker:
  type: xtts  # xtts / openvoice / gpt-sovits
  host: 0.0.0.0
  port: 8001

gateway:
  url: http://localhost:8000

model:
  path: ./models/xtts_v2
  device: cuda  # cuda / cpu
  auto_load: false  # å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½æ¨¡å‹

resources:
  max_concurrent: 5
  gpu_memory_limit: 6GB
```

---

## åã€éªŒæ”¶æ ‡å‡†

- [ ] æ‰€æœ‰é¡µé¢å¯æ­£å¸¸è®¿é—®
- [ ] æœåŠ¡æ³¨å†Œ/å‘ç°æ­£å¸¸å·¥ä½œ
- [ ] å¤šèŠ‚ç‚¹è´Ÿè½½å‡è¡¡æ­£å¸¸
- [ ] èŠ‚ç‚¹å¯åŠ¨/åœæ­¢/å¾…æœºå¯æ§
- [ ] é™æµåŠŸèƒ½æ­£å¸¸
- [ ] æ—¥å¿—è®°å½•å®Œæ•´
- [ ] API æµ‹è¯•é¡µå¯æ­£å¸¸æµ‹è¯•æ‰€æœ‰æ¥å£
- [ ] æ¨¡å‹åˆ†å·å¯æ­£ç¡®è¿˜åŸ
- [ ] ç¦»çº¿éƒ¨ç½²æ–‡æ¡£å®Œæ•´
- [ ] é€šè¿‡å‹åŠ›æµ‹è¯•

---

*æ–‡æ¡£ç‰ˆæœ¬: 1.0*
*åˆ›å»ºæ—¥æœŸ: 2025-11-29*
*ä½œè€…: Claude Code*
