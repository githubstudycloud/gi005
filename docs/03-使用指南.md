# 03 使用指南

## 命令行 (CLI)

### 启动命令

```bash
cd voice-clone-tts

# 单机模式
python -m src.main standalone --engine xtts --port 8080

# 网关模式
python -m src.main gateway --port 8080

# 工作节点
python -m src.main worker --engine xtts --port 8001 --gateway http://localhost:8080
```

### 参数说明

| 参数 | 说明 | 默认值 |
|------|------|--------|
| `--engine` | 引擎类型: xtts/openvoice/gpt-sovits | xtts |
| `--port` | 端口号 | 8080 |
| `--host` | 监听地址 | 0.0.0.0 |
| `--device` | cuda/cpu | cuda |
| `--gateway` | 网关地址 | 无 |
| `--auto-load` | 启动时加载模型 | false |
| `--log-level` | DEBUG/INFO/WARNING/ERROR | INFO |

---

## HTTP API

### 健康检查

```bash
curl http://localhost:8080/health
```

### 提取音色

```bash
curl -X POST http://localhost:8080/api/extract_voice \
  -F "audio=@reference.wav" \
  -F "voice_name=my_voice"
```

响应:
```json
{"success": true, "voice_id": "abc123", "engine": "xtts"}
```

### 合成语音

```bash
curl -X POST http://localhost:8080/api/synthesize \
  -H "Content-Type: application/json" \
  -d '{
    "text": "你好世界",
    "voice_id": "abc123",
    "language": "zh"
  }' --output output.wav
```

### 音色列表

```bash
curl http://localhost:8080/api/voices
```

### 节点状态

```bash
curl http://localhost:8080/api/nodes
```

---

## Web 界面

启动服务后访问:

| 页面 | 地址 | 说明 |
|------|------|------|
| 状态页 | /status | 系统概览、节点状态 |
| 管理页 | /admin | 节点管理、公告发布 |
| 测试页 | /playground | API 在线测试 |
| API文档 | /docs | Swagger 文档 |

---

## 语言代码

| 代码 | 语言 |
|------|------|
| zh | 中文 |
| en | 英语 |
| ja | 日语 |
| ko | 韩语 |
| fr | 法语 |
| de | 德语 |

---

## 参考音频要求

- **格式**: WAV (推荐)、MP3
- **时长**: 5-30 秒
- **采样率**: 16kHz 以上
- **质量**: 清晰无噪音、单人说话

---

## 下一步

- API 详情 → [05-API参考](05-API参考.md)
- 架构说明 → [04-架构设计](04-架构设计.md)
